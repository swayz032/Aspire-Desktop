import { OfficeItem, TimelineMessage } from '@/types/inbox';
import { SUITE_ID, OFFICE_ID } from '@/types/common';
import { officeId } from '@/lib/ids';

const now = new Date();
const hoursAgo = (h: number) => new Date(now.getTime() - h * 3600000).toISOString();
const daysAgo = (d: number) => new Date(now.getTime() - d * 86400000).toISOString();

export const officeItems: OfficeItem[] = [
  {
    id: officeId(1),
    type: 'office',
    title: 'Vendor onboarding — Zenith Supplies',
    preview: 'New vendor registration requires approval for payment setup',
    body: 'A new vendor registration request has been submitted for Zenith Supplies, a regional office supply and equipment provider based in Austin, TX. This request initiates the formal vendor onboarding process and requires management approval before payment credentials can be established in our procurement system.\n\nZenith Supplies has submitted the following documentation for review: (1) completed W-9 tax identification form, (2) certificate of general liability insurance with $2,000,000 coverage, (3) three professional references from existing enterprise clients, and (4) a signed vendor code of conduct agreement. Our compliance team has completed the initial background verification and no adverse findings were reported.\n\nThe proposed engagement includes a 12-month master supply agreement with an estimated annual spend of $48,000-$65,000 across office supplies, printer consumables, and breakroom provisions. Payment terms are proposed at Net-30 via ACH direct deposit. Quinn has reviewed the initial documentation package and confirmed all required forms are properly executed.\n\nApproval is required from the Founder to activate the vendor account in our procurement system and authorize the finance team to establish payment credentials. Once approved, the vendor will be added to our approved supplier list and purchase orders can be issued immediately.',
    timestamp: hoursAgo(1),
    suiteId: SUITE_ID,
    officeId: OFFICE_ID,
    tags: ['Ops', 'Finance'],
    priority: 'High',
    status: 'Open',
    linkedReceiptIds: ['RCP_0001', 'RCP_0002'],
    department: 'Operations',
    requestType: 'Vendor Approval',
    createdAt: hoursAgo(2),
    updatedAt: hoursAgo(1),
    assignedTo: 'Quinn',
    unread: true,
  },
  {
    id: officeId(2),
    type: 'office',
    title: 'Lease renewal discussion',
    preview: 'Annual lease renewal terms received from property management',
    body: 'The property management team at Morrison & Associates has submitted revised lease renewal terms for Suite 1042. The current lease expires February 28, 2026, and a decision is required by February 15th to ensure continuity.\n\nKey changes from the original agreement:\n• Term extended from 3 years to 5 years at a reduced escalation rate of 2.5% annually (down from 3.2%)\n• Early termination clause added after Year 2 with 90-day notice\n• Tenant improvement allowance increased to $45/sqft for Year 1\n• Maintenance responsibility matrix updated — landlord now covers HVAC and common area\n\nAva has flagged this for priority review given the approaching deadline. The legal team recommends the 5-year option for operational stability, but notes the early termination clause should be reviewed carefully. Total projected cost over the 5-year term is approximately $1.2M, representing a 6% savings versus the previous rate structure.',
    timestamp: hoursAgo(3),
    suiteId: SUITE_ID,
    officeId: OFFICE_ID,
    tags: ['Legal', 'Finance'],
    priority: 'High',
    status: 'Waiting',
    linkedReceiptIds: ['RCP_0003'],
    department: 'Legal',
    requestType: 'Contract Review',
    createdAt: daysAgo(2),
    updatedAt: hoursAgo(3),
    assignedTo: 'Ava',
    unread: true,
  },
  {
    id: officeId(3),
    type: 'office',
    title: 'Security audit preparation',
    preview: 'Q1 security compliance audit scheduled for next week',
    body: 'Heads up — the Q1 security audit is confirmed for Feb 17-21. Three auditors from Compliance Partners will need badge access and a workspace.\n\nCole is coordinating prep. Please make sure network diagrams and access logs from the past quarter are ready by the 14th.',
    timestamp: hoursAgo(5),
    suiteId: SUITE_ID,
    officeId: OFFICE_ID,
    tags: ['Security', 'Ops'],
    priority: 'Medium',
    status: 'Open',
    linkedReceiptIds: ['RCP_0004', 'RCP_0005'],
    department: 'IT Security',
    requestType: 'Audit Prep',
    createdAt: daysAgo(3),
    updatedAt: hoursAgo(5),
    assignedTo: 'Cole',
    unread: false,
  },
  {
    id: officeId(4),
    type: 'office',
    title: 'Invoice reminder sent — Acme Corp',
    preview: 'Automated payment reminder dispatched for overdue invoice',
    body: 'An automated payment reminder was sent to Acme Corp for Invoice #2025-12-08 ($23,400), which is now 15 days past due. This is the second reminder in the escalation sequence.\n\nThe invoice covers Q4 consulting services delivered in November-December 2025. Original payment terms were Net-30 from invoice date (January 8, 2026). Quinn reached out to their accounts payable department on February 3rd and was told the payment is "in processing" but no specific date was provided.\n\nRecommended next steps if payment is not received within 5 business days:\n1. Direct call to the CFO contact (David Martinez) to confirm payment timeline\n2. Evaluate whether to apply the 1.5% monthly late fee per the service agreement\n3. Consider pausing any new work orders until the outstanding balance is cleared\n\nNote: Acme Corp has been a reliable client for 3 years with no prior payment issues. This may be an internal processing delay rather than a cash flow concern.',
    timestamp: hoursAgo(8),
    suiteId: SUITE_ID,
    officeId: OFFICE_ID,
    tags: ['Finance'],
    priority: 'Medium',
    status: 'Resolved',
    linkedReceiptIds: ['RCP_0006'],
    department: 'Billing',
    requestType: 'Payment Follow-up',
    createdAt: daysAgo(5),
    updatedAt: hoursAgo(8),
    assignedTo: 'Quinn',
    unread: false,
  },
  {
    id: officeId(5),
    type: 'office',
    title: 'Contract bound — Vendor agreement',
    preview: 'DocuSign signature completed for vendor services agreement',
    body: 'Done — the Meridian Business Services MSA has been fully executed. Both parties signed via DocuSign on February 8, 2026.\n\nContract value: $96K/year ($8K/month). Services start March 1st. Includes managed IT helpdesk, network monitoring, and cybersecurity ops with 99.9% uptime SLA.',
    timestamp: hoursAgo(12),
    suiteId: SUITE_ID,
    officeId: OFFICE_ID,
    tags: ['Legal', 'Ops'],
    priority: 'Low',
    status: 'Resolved',
    linkedReceiptIds: ['RCP_0007', 'RCP_0008'],
    department: 'Legal',
    requestType: 'Contract Execution',
    createdAt: daysAgo(7),
    updatedAt: hoursAgo(12),
    assignedTo: 'Ava',
    unread: false,
  },
  {
    id: officeId(6),
    type: 'office',
    title: 'New client proposal — TechStart Inc',
    preview: 'Draft proposal ready for review before sending',
    body: 'Piper has completed the draft proposal for TechStart Inc and it is ready for your review before we send it over. This is a significant opportunity — TechStart is a Series A startup with 85 employees looking for operational consulting and managed services.\n\nProposal highlights:\n• Tier 2 Enterprise package: $144,000/year\n• Scope: Operations consulting, financial reporting, vendor management, and IT oversight\n• Contract term: 18 months with auto-renewal\n• Implementation timeline: 4-week onboarding\n\nKevin Zhang (VP of Strategic Partnerships at TechStart) has indicated they are evaluating two other vendors and expect to make a decision by end of February. He specifically mentioned that our strengths in financial operations and compliance were a key differentiator.\n\nPiper recommends we include a case study from our work with a similar-stage company (Vertex Operations) and offer a 10% discount on the first 6 months to close the deal. The proposal also includes a provision for expanding to their planned West Coast office (additional 45 users) in Q3.\n\nPlease review the attached proposal and provide feedback by tomorrow so we can send it before their evaluation deadline.',
    timestamp: daysAgo(1),
    suiteId: SUITE_ID,
    officeId: OFFICE_ID,
    tags: ['Sales'],
    priority: 'High',
    status: 'Waiting',
    linkedReceiptIds: ['RCP_0009'],
    department: 'Sales',
    requestType: 'Proposal Review',
    createdAt: daysAgo(3),
    updatedAt: daysAgo(1),
    assignedTo: 'Piper',
    unread: true,
  },
  {
    id: officeId(7),
    type: 'office',
    title: 'Employee expense report — Marketing',
    preview: 'Monthly expense report submitted for approval',
    body: 'Marketing team expense report for January 2026 has been submitted. Total: $8,240.\n\nThree items flagged for review:\n• Team dinner (12 ppl) — $1,200\n• Conference registration — $890\n• Emergency office supplies — $250\n\nAll other line items are within standard approval thresholds. Receipts attached.',
    timestamp: daysAgo(1),
    suiteId: SUITE_ID,
    officeId: OFFICE_ID,
    tags: ['Finance', 'Ops'],
    priority: 'Low',
    status: 'Open',
    linkedReceiptIds: ['RCP_0010'],
    department: 'Finance',
    requestType: 'Expense Approval',
    createdAt: daysAgo(2),
    updatedAt: daysAgo(1),
    assignedTo: 'Quinn',
    unread: false,
  },
  {
    id: officeId(8),
    type: 'office',
    title: 'IT infrastructure upgrade request',
    preview: 'Server migration proposal from cloud provider',
    body: 'Cloud Solutions has submitted a comprehensive proposal for migrating our on-premises infrastructure to AWS. Cole has reviewed the technical approach and recommends we proceed, pending budget approval.\n\nCurrent state: 12 physical servers, 3 NAS arrays (48TB), estimated annual cost $142,000 including hardware maintenance, power, and cooling.\n\nProposed architecture:\n• Production workloads → EC2 with auto-scaling groups\n• Databases → RDS Multi-AZ for high availability\n• File storage → S3 with lifecycle policies\n• Hybrid connectivity via site-to-site VPN during transition\n\nFinancial summary:\n• Projected annual cloud cost: $98,400 (31% reduction)\n• One-time migration fee: $65,000\n• Break-even point: 18 months\n• 3-year net savings: $65,800\n\nThe migration would be phased over 16 weeks — non-production first, then a zero-downtime production cutover. The proposal includes 6 months of 24/7 managed services post-migration and full knowledge transfer documentation.\n\nCole notes that the primary risk is the database migration, which involves 3.2TB of production data with complex relational constraints. He recommends a parallel-run period of at least 2 weeks before decommissioning the on-prem servers.',
    timestamp: daysAgo(2),
    suiteId: SUITE_ID,
    officeId: OFFICE_ID,
    tags: ['Security', 'Ops'],
    priority: 'Medium',
    status: 'Waiting',
    linkedReceiptIds: ['RCP_0011'],
    department: 'IT',
    requestType: 'Infrastructure',
    createdAt: daysAgo(5),
    updatedAt: daysAgo(2),
    assignedTo: 'Cole',
    unread: false,
  },
  {
    id: officeId(9),
    type: 'office',
    title: 'Client feedback review — Q4 Survey',
    preview: 'Quarterly client satisfaction results ready for analysis',
    body: 'Q4 survey results are in. 78% response rate across 42 active accounts — our best participation yet.\n\nHighlights: NPS score 72 (industry avg 45), overall satisfaction 4.6/5, retention rate 96.4%. Clients love our responsiveness and account management.\n\nAreas to improve: onboarding speed (3 weeks → target 2), self-service reporting (34% want dashboards), and after-hours support (28% want extended hours).\n\nFull report with individual client responses and action plan is attached.',
    timestamp: daysAgo(3),
    suiteId: SUITE_ID,
    officeId: OFFICE_ID,
    tags: ['Sales', 'Ops'],
    priority: 'Medium',
    status: 'Open',
    linkedReceiptIds: ['RCP_0012'],
    department: 'Client Success',
    requestType: 'Feedback Analysis',
    createdAt: daysAgo(4),
    updatedAt: daysAgo(3),
    assignedTo: 'Nara',
    unread: false,
  },
  {
    id: officeId(10),
    type: 'office',
    title: 'Marketing campaign approval',
    preview: 'Q1 digital marketing budget allocation needs sign-off',
    body: 'The marketing agency has submitted the Q1 2026 digital campaign plan. Total budget request: $45,000. Theme: "Digital Transformation Leadership" positioning Zenith as the go-to partner for mid-market operational modernization.\n\nBudget breakdown:\n• LinkedIn Ads: $15,000 (sponsored content + InMail + lead gen)\n• Content/SEO: $12,000 (8 articles, 2 whitepapers, 1 industry report)\n• Google Ads: $10,000 (branded + non-branded search)\n• Social media: $5,000 (daily posting + influencer outreach)\n• Email campaigns: $3,000 (12-touch nurture for 3,500 prospects)\n\nTargets: 200+ MQLs, 40% traffic increase, CPL under $225. Campaign ready to launch Feb 15 pending your approval. Creative assets are in final production.\n\nNova recommends approving with one adjustment: shifting $2,000 from Google Display to LinkedIn given our B2B audience profile and the stronger conversion rates we saw in Q4.',
    timestamp: daysAgo(4),
    suiteId: SUITE_ID,
    officeId: OFFICE_ID,
    tags: ['Finance', 'Sales'],
    priority: 'Medium',
    status: 'Waiting',
    linkedReceiptIds: ['RCP_0013'],
    department: 'Marketing',
    requestType: 'Budget Approval',
    createdAt: daysAgo(6),
    updatedAt: daysAgo(4),
    assignedTo: 'Nova',
    unread: false,
  },
  {
    id: officeId(11),
    type: 'office',
    title: 'Insurance policy renewal',
    preview: 'Annual business liability insurance requires renewal decision',
    body: 'Insurance renewal is due March 1st. Decision needed by Feb 20 to avoid a coverage lapse.\n\nCurrent policy: $5M per occurrence / $10M aggregate, $2,500 deductible, includes E&O ($3M) and cyber liability ($2M). Current premium: $18,400/year.\n\nThree renewal options presented:\n\nOption A — Same coverage, $19,320/year (+5% market adjustment)\nOption B — Enhanced cyber to $5M + employment practices liability, $23,100/year (recommended)\nOption C — Full package including D&O coverage, $27,500/year\n\nThe broker recommends Option B given our expanded digital operations and remote workforce. Ava agrees — the additional cyber protection addresses real exposure given the cloud migration plans. Comparison matrix attached.',
    timestamp: daysAgo(5),
    suiteId: SUITE_ID,
    officeId: OFFICE_ID,
    tags: ['Legal', 'Finance'],
    priority: 'High',
    status: 'Open',
    linkedReceiptIds: ['RCP_0014'],
    department: 'Operations',
    requestType: 'Policy Renewal',
    createdAt: daysAgo(10),
    updatedAt: daysAgo(5),
    assignedTo: 'Ava',
    unread: true,
  },
  {
    id: officeId(12),
    type: 'office',
    title: 'Compliance training completion',
    preview: 'Team compliance certifications due for renewal',
    body: 'Quick update — 18 of 26 team members have completed their annual compliance training. 4 are in progress, 4 haven\'t started yet. Deadline is Feb 28.\n\nClara is following up with the remaining staff. Modules include AML, GDPR/CCPA, workplace safety, infosec, and code of conduct. All available through the LMS at training.zenithsolutions.com.',
    timestamp: daysAgo(6),
    suiteId: SUITE_ID,
    officeId: OFFICE_ID,
    tags: ['Security', 'Ops'],
    priority: 'Low',
    status: 'Resolved',
    linkedReceiptIds: ['RCP_0015'],
    department: 'HR',
    requestType: 'Training',
    createdAt: daysAgo(14),
    updatedAt: daysAgo(6),
    assignedTo: 'Clara',
    unread: false,
  },
];

export function getOfficeItemTimeline(id: string): TimelineMessage[] {
  return [
    {
      id: 'msg_1',
      sender: 'System',
      senderRole: 'Automated',
      content: 'Item created and assigned to queue.',
      timestamp: daysAgo(2),
      isAI: true,
    },
    {
      id: 'msg_2',
      sender: 'Quinn',
      senderRole: 'Billing Specialist',
      content: 'Reviewed initial documentation. Pending vendor verification.',
      timestamp: daysAgo(1),
      isAI: true,
    },
    {
      id: 'msg_3',
      sender: 'Ava',
      senderRole: 'Chief of Staff',
      content: 'Flagged for priority review. Recommend expedited processing.',
      timestamp: hoursAgo(12),
      isAI: true,
    },
    {
      id: 'msg_4',
      sender: 'Human',
      senderRole: 'Founder',
      content: 'Approved for next steps. Please proceed with verification.',
      timestamp: hoursAgo(6),
      isAI: false,
    },
    {
      id: 'msg_5',
      sender: 'Quinn',
      senderRole: 'Billing Specialist',
      content: 'Verification complete. Ready for final approval.',
      timestamp: hoursAgo(2),
      isAI: true,
    },
  ];
}
